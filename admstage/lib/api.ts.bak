export const GW_BASE =
  process.env.NEXT_PUBLIC_GATEWAY_BASE ||
  process.env.NEXT_PUBLIC_GATEWAY || // legacy fallback
  "http://localhost:3044";

type Json = any;

export async function getJson(path: string): Promise<Json> {
  const url = path.startsWith("http") ? path : `${GW_BASE}${path}`;
  const res = await fetch(url, { cache: "no-store" });
  if (!res.ok) {
    let msg = `HTTP ${res.status}`;
    try {
      const body = await res.text();
      msg += `: ${body}`;
    } catch {}
    throw new Error(msg);
  }
  return res.json();
}
